<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Social Growth ‚Ä¢ Order History</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
*{margin:0;padding:0;box-sizing:border-box;font-family:system-ui}

body{
  height:100vh;
  background:
    radial-gradient(circle at 20% 20%,#00f2ff22,transparent 40%),
    radial-gradient(circle at 80% 80%,#00ff8822,transparent 40%),
    linear-gradient(135deg,#0f2027,#203a43,#2c5364);
  color:#fff;
  display:flex;
  flex-direction:column;
  overflow:hidden;
}

.topbar{
  height:70px;
  display:flex;
  align-items:center;
  justify-content:center;
  position:relative;
  background:rgba(0,0,0,.4);
  backdrop-filter:blur(15px);
  flex-shrink:0;
}

.logo{height:50px}

.menu{
  position:absolute;
  right:20px;
  font-size:26px;
  cursor:pointer;
}

.drawer{
  position:fixed;
  top:0;
  right:-280px;
  width:260px;
  height:100%;
  background:rgba(0,0,0,.95);
  backdrop-filter:blur(20px);
  padding:30px 20px;
  transition:.4s;
  z-index:999;
}

.drawer.open{right:0}

.drawer a{
  display:block;
  padding:14px;
  margin:10px 0;
  border-radius:15px;
  background:rgba(255,255,255,.08);
  color:#fff;
  text-decoration:none;
}

.main{
  flex:1;
  padding:20px;
  display:flex;
  justify-content:center;
  overflow:hidden;
}

.card{
  width:100%;
  max-width:950px;
  background:rgba(255,255,255,.08);
  backdrop-filter:blur(25px);
  border-radius:30px;
  padding:25px;
  box-shadow:0 0 60px rgba(0,255,200,.2);
  display:flex;
  flex-direction:column;
}

.tableWrapper{
  flex:1;
  overflow:auto;
  margin-top:20px;
}

table{
  width:100%;
  border-collapse:collapse;
}

th,td{
  padding:14px;
  text-align:center;
}

th{
  background:rgba(0,255,255,.2);
  border-radius:8px;
}

.status{
  padding:8px 16px;
  border-radius:25px;
  font-weight:700;
  display:inline-block;
}

.pending{
  color:#ffaa00;
  background:#ffaa0022;
  box-shadow:0 0 12px #ffaa00;
}

.completed{
  color:#00ff88;
  background:#00ff8822;
  box-shadow:0 0 15px #00ff88;
}

.cancelled{
  color:#ff4444;
  background:#ff444422;
  box-shadow:0 0 15px #ff4444;
}

tbody tr{
  animation:fade .5s ease forwards;
  opacity:0;
}
@keyframes fade{to{opacity:1}}

</style>
</head>

<body>

<div class="topbar">
  <img src="logo.png" class="logo">
  <div class="menu" onclick="toggleMenu()">‚ãÆ</div>
</div>

<div class="drawer" id="drawer">
  <a href="home.html">üè† Home</a>
  <a href="order.html">üöÄ New Order</a>
  <a href="addfund.html">üí∞ Add Fund</a>
  <a href="history.html">üìú History</a>
  <a href="customer.html">üéß Customer Service</a>
</div>

<div class="main">
  <div class="card">
    <h2>üìú Order History</h2>

    <div class="tableWrapper">
      <table>
        <thead>
          <tr>
            <th>Service</th>
            <th>Qty</th>
            <th>Price</th>
            <th>Status</th>
            <th>Date</th>
          </tr>
        </thead>
        <tbody id="orderTable">
          <tr><td colspan="5">Loading...</td></tr>
        </tbody>
      </table>
    </div>

  </div>
</div>

<script>

const API_URL="https://script.google.com/macros/s/AKfycby0UHijonDZaPPVyGpjKsAsc9OUTJusetjoQMwygHmiwPd7otW7B1p0D_oIwmuh5rIbIw/exec";
const userID=localStorage.getItem("userID");

if(!userID){
  window.location="index.html";
}

function toggleMenu(){
  document.getElementById("drawer").classList.toggle("open");
}

/* LOAD ORDERS */
fetch(API_URL,{
  method:"POST",
  body:JSON.stringify({
    action:"getOrders",
    userID:userID
  })
})
.then(r=>r.json())
.then(d=>{

  const table=document.getElementById("orderTable");
  table.innerHTML="";

  if(!d.orders || d.orders.length===0){
    table.innerHTML="<tr><td colspan='5'>No Orders Found</td></tr>";
    return;
  }

  d.orders.forEach((o,index)=>{

    let statusClass="pending";

    if(o.status.toLowerCase().includes("complete"))
      statusClass="completed";

    if(o.status.toLowerCase().includes("cancel"))
      statusClass="cancelled";

    table.innerHTML+=`
    <tr style="animation-delay:${index*0.1}s">
      <td>${o.service}</td>
      <td>${o.quantity}</td>
      <td>‚Çπ${o.price}</td>
      <td><span class="status ${statusClass}">${o.status}</span></td>
      <td>${o.date}</td>
    </tr>`;
  });

})
.catch(()=>{
  document.getElementById("orderTable").innerHTML=
  "<tr><td colspan='5'>Failed to load data</td></tr>";
});

</script>

</body>
</html>